name: "authors update"
on:
  schedule:
    # Run once a week at 00:05 AM UTC on Sunday.
    - cron: "5 0 * * 0"

  workflow_dispatch:

jobs:
  authors_update:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v3
        with:
          fetch-depth: "0" # This is required to actually get all the authors
          persist-credentials: false
      - run: "dev/update-authors.js" # Run the AUTHORS tool
      - uses: gr2m/create-or-update-pull-request-action@v1 # Create a PR or update the Action's existing PR
        env:
          GITHUB_TOKEN: ${{ secrets.GITHUB_TOKEN }}
        with:
          body: >
            Here are some new additions to the AUTHORS file for the v6 branch.
            This is an automatically generated PR by the
            `authors.yml` GitHub Action, which runs `dev/update-authors.js`.
          branch: "actions/authors-update-v6" # Custom branch *just* for this Action.
          commit-message: "meta: update sequelize AUTHORS"
          labels: meta
          title: "meta: update sequelize AUTHORS (v6)"
